<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org">
	<head>

  	<link th:rel="stylesheet" th:href="@{/webjars/bootstrap/4.5.3/css/bootstrap.min.css} " />
  	<link href="../static/css/CustomBootstrap.css" th:href="@{/css/CustomBootstrap.css}" rel="stylesheet" />
  	
 	 <style>
 	 
  	 .form-control-xs {
   	 	height: calc(1em + .375rem + 2px) !important;
    	padding: .125rem .25rem !important;
    	font-size: .75rem !important;
    	line-height: 1.5;
    	border-radius: .2rem;
		}
	
	h3 {
  		font-weight: bold !important;
  		color: #495057 !important;
  		font-size: 30px !important;
  		
  		border-bottom: 2px solid #000 !important;
 		background:#e9ecef !important;
  		color:#003B49 !important;

  		display:inline-block !important;
  		padding:8px 20px !important;
 		margin-left:10px !important;
		}
		
	h5 {
  		color: #F2A900 !important;
  		font-size: 26px !important;
  		
 		background:#e9ecef !important;
  		color:#F2A900 !important;

  		display:inline-block !important;
  		padding:3px 15px !important;
 		margin-left:10px !important;
		}

  </style>
  
  	<script th:src="@{/webjars/jquery/3.5.1/jquery.min.js}"></script>
	<script th:src="@{/webjars/popper.js/1.14.3/umd/popper.min.js}"></script>
	<script th:src="@{/webjars/bootstrap/4.5.3/js/bootstrap.min.js}"></script>
  
	<script th:inline="javascript">
	
	/*<![CDATA[*/
		var idUsuarioParam = [[${idUsuarioApli}]];
	/*]]>*/
	
	 var arrValueCheck = null;
	 var arrValueCheckASupr  = null;
	 var idMenuSelec = "";

		$(document).ready(function() {

			  $('[name="checks[]"]').click(function() {
			      arrValueCheck = $('[name="checks[]"]:checked').map(function(){
			      return this.value;
			    }).get();
			     
			  // var str = arrValueCheck.join(',');
			  //  $('#arr').text(JSON.stringify(arr));
			  //  $('#str').text(str);
			  });
			  
			  $('[name="checksMenuUsu[]"]').click(function() {
				  arrValueCheckASupr = $('[name="checksMenuUsu[]"]:checked').map(function(){
			      return this.value;
			    }).get();
			  
			  });
			 
			 $("#idLinkAnadirTodos").click(function() {
				 alert("boton idLinkAnadirTodos");
				 $("input[id^='idCheckActivado']").prop("checked", true);
				 
				 document.getElementById("idP3").style.display = "block";
				 $("#idAccionHidden" + ind).val("anadirtodos");
				 
				 $("#myModalConfirm").modal();
				 
			  });
			 
			 $("#idLinkConfirmar").click(function() {
				    alert("boton confirmar");
				  });

			});
		
		function anadirElemenMenuUsuario()
	  	 {
			if (arrValueCheck == null)
				{
				 alert("Debe seleccionar al menos un elemento a añadir"); 
				 return;
				}
			 else
			  {
				if (arrValueCheck.length == 0)
					{
					 alert("Debe seleccionar al menos un elemento a añadir");
					 return;
					}
				else
					{
					 document.getElementById("idP1").style.display = "block";
					 
					 var ind = 1;
					 for (var i=0; i<arrValueCheck.length; i++)
				 	 {
					  $("#idIdMenuHidden" + ind).val( arrValueCheck[i] );
					  alert( $("#idIdMenuHidden" + ind).val() );
				 	 // idMenuSelec = arrValueCheck[i];
			   	    }
					 $("#idAccionHidden" + ind).val( "anadiruno" );  
					 $("#myModalConfirm").modal();
					}
			
			  }
	  	 }
		
		function eliminarElemenMenuUsuario()
	  	 {
			if (arrValueCheckASupr == null)
				{
				 alert("Debe seleccionar al menos un elemento a suprimir"); 
				}
			 else
			  {
				if (arrValueCheckASupr.length == 0)
					{
					 alert("Debe seleccionar al menos un elemento a suprimir");
					}
				else
					{
					 document.getElementById("idP2").style.display = "block";
					 
					 var ind = 1;
					 for (var i=0; i<arrValueCheckASupr.length; i++)
				 	  { 
					   $("#idIdMenuHidden" + ind).val( arrValueCheckASupr[i] );
					   alert( $("#idIdMenuHidden" + ind).val() )
				 	  // idMenuSelec = arrValueCheck[i];
			   	      }
					$("#idAccionHidden").val("suprimiruno");  
					 alert("Debe " + $("#idAccionHidden").val());
					$("#myModalConfirm").modal();
					}
	  			}
		}
		
		function confirmarMenuUsuario()
	  	 {
		 // Submitir formulario
			document.getElementById("idFormMenuUsuario").submit();
	  	 }
	</script>

  </head>

  <body>
  
	<div th:insert="Aplicacion/fragments/BotoneraMenuCabecera2 :: menucabecera"></div>
	
	<div class="container-fluid">
		<div class="row">
			<div class="titulo-pag2" th:text="'Gestión menus para el usuario: ' + ${nomUsuario}"></div>
		</div>
		
		<div class="row" style="border-bottom: 2px solid #000">
		<div class="col-1"> </div>
		 
		<form th:id="idFormMenuUsuario" th:action="@{/gestionmenususuario/actualizarmenuusuario}" th:object="${beanCamposGesMenuUsu}" method="post">
			
			<input type="hidden" th:id="'idAccionHidden'" 	th:name="'accionHidden'"   th:field="*{idAccion}" />
			<input type="hidden" th:id="'IdIdUsuario'" 		th:name="'idUsuario'"      th:field="*{idUsuario}" />
		 	<input type="hidden" th:id="'idIdMenuHidden1'"  th:name="'idMenuHidden1'"  th:field="*{idMenu1}" />
		 	<input type="hidden" th:id="'idIdMenuHidden2'"  th:name="'idMenuHidden2'"  th:field="*{idMenu2}" />
		 	<input type="hidden" th:id="'idIdMenuHidden3'"  th:name="'idMenuHidden3'"  th:field="*{idMenu3}" />	
		 	<input type="hidden" th:id="'idIdMenuHidden4'"  th:name="'idMenuHidden4'"  th:field="*{idMenu4}" />	
		 	<input type="hidden" th:id="'idIdMenuHidden5'"  th:name="'idMenuHidden5'"  th:field="*{idMenu5}" />	
		 	<input type="hidden" th:id="'idIdMenuHidden6'"  th:name="'idMenuHidden6'"  th:field="*{idMenu6}" />	
		 	<input type="hidden" th:id="'idIdMenuHidden7'"  th:name="'idMenuHidden7'"  th:field="*{idMenu7}" />	
		 	<input type="hidden" th:id="'idIdMenuHidden8'"  th:name="'idMenuHidden8'"  th:field="*{idMenu8}" />	
		 	<input type="hidden" th:id="'idIdMenuHidden9'"  th:name="'idMenuHidden9'"  th:field="*{idMenu9}" />						
		 </form> 

  			<div class="col-5">
  				<h5 th:text="'Opciones de menu activos para el usuario'"></h5>
  				<div id="idDivSubMenu1Usu">
					<div th:insert="gestionMenus/fragments/MenusSelecUsuario :: menuselecusuario"></div>
				</div>	
			</div>
 			<div class="col-1" style="text-align: center">
 				<div class="btn-group-vertical" role="group" aria-label="Vertical button group">
 					<br/>
 					<br/>
 					<br/>
				 	<a th:id="'idLinkAnadir'"      th:name="'linkAnadir'"  th:onclick="th:anadirElemenMenuUsuario()" class="btn btn-primary btn-sm" role="button"> &#8678; Añadir</a>
					<br/>
					<a th:id="'idLinkSuprimir'"    th:name="'linkSuprimir'" th:onclick="th:eliminarElemenMenuUsuario()" class="btn btn-colour-1" role="button">Suprimir &#8680;</a>
					<br/>
					<a th:id="'idLinkAnadirTodos'" th:name="'linkAnadirTodos'" class="btn btn-colour-1" role="button">&#8920; Añadir todos</a>
				</div> 
 			</div>
 			<div class="col-4">
 				<h5 th:text="'Opciones del menu principal disponibles'"></h5>
 				<div th:insert="gestionMenus/fragments/MenusAplicaDispUsuario :: menuapliselecusuario"></div>
 			</div>
 		 
 			<div class="col-1"> </div>
		</div>
		
		<a th:id="'idLinkVolver'" th:name="'linkVolver'" class="btn btn-colour-1" role="button">Volver</a>
 
      	<div id="idDivSubMenu1Usu" style="visibility:visible; width:100%"> </div>
	</div>
	
  <!-- Modal Confirmación -->
  <div id="myModalConfirm" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Confirmación elementos menu</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
      	<p th:id="'idP1'" style="display:none;"> ¿Confirmar que quiere añadir los elementos de menu seleccionados a menu este usuario?.</p>
      	<p th:id="'idP2'" style="display:none;"> ¿Confirmar que quiere suprimir los elementos de menu seleccionados a menu este usuario?.</p>
      	<p th:id="'idP3'" style="display:none;"> ¿Confirmar que quiere añadir todos los elementos de menu a este usuario?.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Cancelar</button>
        <button type="button" th:onclick="th:confirmarMenuUsuario()" class="btn btn-primary">Confirmar</button>
      </div>
    </div>
  </div>
</div>
	
  </body>
</html>
