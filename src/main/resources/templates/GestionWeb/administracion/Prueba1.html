<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org">

<head>
  	<link th:rel="stylesheet" th:href="@{/webjars/bootstrap/4.5.3/css/bootstrap.min.css}" />
	<link th:rel="stylesheet" th:href="@{/css/CustomBootstrap.css}" />
	
	<link th:rel="stylesheet" th:href="@{/webjars/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker3.css}"/>
    <link th:rel="stylesheet" th:href="@{/webjars/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker3.standalone.css}"/>
    
    <script th:src="@{/webjars/jquery/3.5.1/jquery.min.js}"></script>
	<script th:src="@{/webjars/popper.js/1.14.3/umd/popper.min.js}"></script>
	<script th:src="@{/webjars/bootstrap/4.5.3/js/bootstrap.min.js}"></script>
	
  <style>
	.navbar .dropdown-toggle, .navbar .dropdown-menu a {
		cursor: pointer;
	}

	.navbar .dropdown-item.active, .navbar .dropdown-item:active {
		color: inherit;
		text-decoration: none;
		background-color: inherit;
	}

	.navbar .dropdown-item:focus, .navbar .dropdown-item:hover {
		color: #16181b;
		text-decoration: none;
		background-color: #f8f9fa;
	}

	@media ( min-width : 767px) {
	.navbar .dropdown-toggle:not (.nav-link )::after {
		display: inline-block;
		width: 0;
		height: 0;
		margin-left: .5em;
		vertical-align: 0;
		border-bottom: .3em solid transparent;
		border-top: .3em solid transparent;
		border-left: .3em solid;
	}
}
</style>

 <script th:inline="javascript">

	$(document).ready(function() {

		$('.navbar .dropdown-item').on('click', function(e) {
			var $el = $(this).children('.dropdown-toggle');
			var $parent = $el.offsetParent(".dropdown-menu");
			$(this).parent("li").toggleClass('open');

			if (!$parent.parent().hasClass('navbar-nav')) {
				if ($parent.hasClass('show')) {
					$parent.removeClass('show');
					$el.next().removeClass('show');
					$el.next().css({
						"top" : -999,
						"left" : -999
					});
				} else {
					$parent.parent().find('.show').removeClass('show');
					$parent.addClass('show');
					$el.next().addClass('show');
					$el.next().css({
						"top" : $el[0].offsetTop,
						"left" : $parent.outerWidth() - 4
					});
				}
				e.preventDefault();
				e.stopPropagation();
			}
		});

		$('.navbar .dropdown').on('hidden.bs.dropdown', function() {
			$(this).find('li.dropdown').removeClass('show open');
			$(this).find('ul.dropdown-menu').removeClass('show open');
		});

	});
 </script>
</head>

<body>
	<header th:fragment="menucabecera">
	
		<script th:inline="javascript">
		 function logoutSys()
	 	 {
	  	  document.getElementById("idFormLogout").submit();		
	  	 }
		</script>
	
		<div class="navbar navbar-expand-md navbar-dark bg-dark mb-4" role="navigation">
			
			<a class="navbar-brand" th:href="@{/}">Beigar</a>

			<button class="navbar-toggler" type="button" data-toggle="collapse"
				data-target="#navbarCollapse" aria-controls="navbarCollapse"
				aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarCollapse">
				<ul class="navbar-nav mr-auto">

				<li class="nav-item dropdown" th:each="elemenMenuPrincipal : ${opcionesMenuUsuario}">
					<a class="nav-link dropdown-toggle" th:id="'dropdown'+ ${elemenMenuPrincipal.idMenuSesion}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" th:text="${elemenMenuPrincipal.textoMenuSesion}"></a>

						<ul class="dropdown-menu" th:aria-labelledby="'dropdown'+ ${elemenMenuPrincipal.idMenuSesion}" th:if="${not #lists.isEmpty(elemenMenuPrincipal.listBeanSubMenuN1UsuSession)}">
							<th:block th:each="eleSubMenuN1 : ${elemenMenuPrincipal.listBeanSubMenuN1UsuSession}">
								<li class="dropdown-item"><a th:href="${eleSubMenuN1.hrefAplicacionN1Session}" th:text="${eleSubMenuN1.textoSubMenuN1Session}"></a></li>
							</th:block>
						</ul>
					</li>
				</ul>
        		<div class="navbar-brand" sec:authorize="isAuthenticated()">
					<img src="/images/botonOff2.png" width="40" height="40" th:alt="desconectar" th:onclick="logoutSys();"></img>
					<b><span>Usuario: </span><span sec:authentication="name"></span></b>
					<form th:id="idFormLogout" th:action="@{/logout}" method="post">
				<!-- 	<input type="submit" value="Logout" />  -->
					</form>
				</div>
			</div>
	</div>
	</header>
</body>
</html>
